/*
DROP TABLE CLASSIC_REIMBURSEMENT;
DROP TABLE CUSTOMER_REIMBURSEMENT;
*/

CREATE TABLE CLASSIC_REIMBURSEMENT (
    CLASSIC_REIMBURSEMENT_NUMBER             serial primary key,
    CLASSIC_REIMBURSEMENT_LABEL               VARCHAR(12) default 'N/A',
    CLASSIC_REIMBURSEMENT_DOCTOR              numeric(3) default 0,
    CLASSIC_REIMBURSEMENT_PARMEDICAL          numeric(3) default 0,
    CLASSIC_REIMBURSEMENT_HOSPITAL            numeric(3) default 0,
    CLASSIC_REIMBURSEMENT_SINGLE_GLASSES      numeric(3) default 0,
    CLASSIC_REIMBURSEMENT_PROGRESSIVE_GLASSES numeric(3) default 0,
    CLASSIC_REIMBURSEMENT_MOLAR_CROWNS        numeric(3) default 0,
    CLASSIC_REIMBURSEMENT_NON_MOLAR_CROWNS    numeric(3) default 0,
    CLASSIC_REIMBURSEMENT_DESCALINGS          numeric(3) default 0  
);

INSERT INTO CLASSIC_REIMBURSEMENT (CLASSIC_REIMBURSEMENT_LABEL, CLASSIC_REIMBURSEMENT_DOCTOR,
CLASSIC_REIMBURSEMENT_PARMEDICAL, CLASSIC_REIMBURSEMENT_HOSPITAL, 
CLASSIC_REIMBURSEMENT_SINGLE_GLASSES, CLASSIC_REIMBURSEMENT_PROGRESSIVE_GLASSES ,
CLASSIC_REIMBURSEMENT_MOLAR_CROWNS, CLASSIC_REIMBURSEMENT_NON_MOLAR_CROWNS,
CLASSIC_REIMBURSEMENT_DESCALINGS)
VALUES 
('ALLEGE', 100, 100, 100, 30, 33, 16, 100, 100),
('MODERE', 120, 100, 150, 60, 66, 33, 100, 100),
('EXCELLENCE', 240, 150, 280, 98, 98, 80, 100, 100)
;
SELECT COUNT(*) FROM CLASSIC_REIMBURSEMENT;

CREATE TABLE CUSTOMER_REIMBOURSEMENT_ARCHIVE (
    UUID_CUSTOMER_REIMBOURSEMENT_ARCHIVE UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    UUID_CUSTOMER                        UUID,
    ARCHIVE_NUM                          VARCHAR (10),
    ARCHIVE_CREATE_DATE                  date,
    ARCHIVE_COST                         decimal default 0,
    ARCHIVE_DOC                         numeric(3) default 0,
    ARCHIVE_PARMEDICAL                  numeric(3) default 0,
    ARCHIVE_HOSPITAL                    numeric(3) default 0,
    ARCHIVE_SINGLE_GLASSES              numeric(3) default 0,
    ARCHIVE_PROGRESSIVE_GLASSES         numeric(3) default 0,
    ARCHIVE_MOLAR_CROWNS                numeric(3) default 0,
    ARCHIVE_NON_MOLAR_CROWNS            numeric(3) default 0,
    ARCHIVE_DESCALINGS                  numeric(3) default 0
);

CREATE TABLE CUSTOMER_REIMBURSEMENT (
    UUID_CUSTOMER_REIMBOURSEMENT UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    UUID_CUSTOMER                      UUID,
    REIMBURSEMENT_NUM                  VARCHAR (10),
    REIMBURSEMENT_CREATE_DATE         date,
    REIMBURSEMENT_COST                 decimal default 0,
    REIMBURSEMENT_DOCTOR              numeric(3) default 0,
    REIMBURSEMENT_PARMEDICAL          numeric(3) default 0,
    REIMBURSEMENT_HOSPITAL            numeric(3) default 0,
    REIMBURSEMENT_SINGLE_GLASSES      numeric(3) default 0,
    REIMBURSEMENT_PROGRESSIVE_GLASSES numeric(3) default 0,
    REIMBURSEMENT_MOLAR_CROWNS        numeric(3) default 0,
    REIMBURSEMENT_NON_MOLAR_CROWNS    numeric(3) default 0,
    REIMBURSEMENT_DESCALINGS          numeric(3) default 0  
);

INSERT INTO CUSTOMER_REIMBURSEMENT (UUID_CUSTOMER, REIMBURSEMENT_NUM,  
REIMBURSEMENT_CREATE_DATE, REIMBURSEMENT_COST, REIMBURSEMENT_DOCTOR, 
REIMBURSEMENT_PARMEDICAL, REIMBURSEMENT_HOSPITAL, REIMBURSEMENT_SINGLE_GLASSES, 
REIMBURSEMENT_PROGRESSIVE_GLASSES, REIMBURSEMENT_MOLAR_CROWNS, 
REIMBURSEMENT_NON_MOLAR_CROWNS, REIMBURSEMENT_DESCALINGS)
VALUES 
((SELECT UUID_CUSTOMER FROM CUSTOMER WHERE CUSTOMER_LASTNAME = 'Dupont' AND CUSTOMER_FIRSTNAME = 'Jean'), 
'ALL2404001', '2024-04-05', 0, 100, 150, 150, 30, 98, 80, 100, 100 
  ),
((SELECT UUID_CUSTOMER FROM CUSTOMER WHERE CUSTOMER_LASTNAME = 'Bernard' AND CUSTOMER_FIRSTNAME = 'Jacques'),
  'EXC1407001','2014-07-15',0, 240, 150, 280, 98, 98, 80, 100, 10
  )
;
SELECT COUNT(*) FROM CUSTOMER_REIMBURSEMENT;
